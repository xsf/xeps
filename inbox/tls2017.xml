<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE xep SYSTEM 'xep.dtd' [
<!ENTITY MANIFESTO "<span class='ref'><link url='https://xmpp.org/2013/11/xmpp-ubiquitous-encryption-a-manifesto'>manifesto</link></span> <note>A Public Statement Regarding Ubiquitous Encryption on the XMPP Network &lt;<link url='https://xmpp.org/2013/11/xmpp-ubiquitous-encryption-a-manifesto'>https://xmpp.org/2013/11/xmpp-ubiquitous-encryption-a-manifesto</link>&gt;</note>"  >
<!ENTITY % ents SYSTEM 'xep.ent'>
%ents;
]>
<?xml-stylesheet type='text/xsl' href='xep.xsl'?>
<xep>
  <header>
    <title>TLS Recommendations for 2017</title>
    <abstract>
      This document specifies recommended TLS versions, configurations, and
      practices for 2017.
    </abstract>
    &LEGALNOTICE;
    <number>xxxx</number>
    <status>ProtoXEP</status>
    <type>Standards Track</type>
    <sig>Standards</sig>
    <dependencies>
      <spec>RFC 2246</spec>
      <spec>RFC 2631</spec>
      <spec>RFC 4346</spec>
      <spec>RFC 5246</spec>
      <spec>RFC 5802</spec>
      <spec>RFC 5929</spec>
      <spec>RFC 6120</spec>
      <spec>RFC 7590</spec>
      <spec>RFC 7627</spec>
      <spec>RFC 7677</spec>
      <spec>XEP-0368</spec>
    </dependencies>
    <supersedes/>
    <supersededby/>
    <shortname>TLS2017</shortname>
    &sam;
    <revision>
      <version>0.0.1</version>
      <date>2017-01-17</date>
      <initials>ssw</initials>
      <remark>
        <p>First draft.</p>
      </remark>
    </revision>
  </header>
  <section1 topic='Introduction' anchor='intro'>
    <p>
      In 2013 Peter Saint-Andre wrote a &MANIFESTO; to provide recommendations
      for server developers regarding securing the XMPP network.
      The manifesto was designed as a one off tool to make encrypted connections
      the defacto standard on the network.
      However, since 2013 the landscape of encryption on the internet has
      changed: practical vulnerabilities have been found in common TLS ciphers,
      and the use of SSL has been deprecated altogether.
      The following document outlines recommendations for use of the TLS
      protocol in XMPP in a more flexible and agile manner.
      It is expected that this document will be regularly reviewed and reissued
      to prevent these recommendations from atrophying.
    </p>
    <p>
      This document suplements &mdash; but does not supersede &mdash; any of the
      recommendations made in &rfc7590;.
    </p>
  </section1>
  <section1 topic='Protocol Versions' anchor='versions'>
    <section2 topic='Client-to-Server' anchor='pvc2s'>
      <ul>
        <li>Legacy SSL: MUST NOT</li>
        <li>TLS 1.0 (&rfc2246;): NOT RECOMMENDED</li>
        <li>TLS 1.1 (&rfc4346;): MUST</li>
        <li>TLS 1.2 (&rfc5246;): MUST</li>
      </ul>
    </section2>
    <section2 topic='Server-to-Server' anchor='pvs2s'>
      <ul>
        <li>Legacy SSL: MUST NOT</li>
        <li>TLS 1.0 (&rfc2246;): SHOULD</li>
        <li>TLS 1.1 (&rfc4346;): MUST</li>
        <li>TLS 1.2 (&rfc5246;): MUST</li>
      </ul>
    </section2>
  </section1>
  <section1 topic='Connection Mechanisms' anchor='mechanisms'>
    <p>
      Entities that are capable of making DNS SRV record requests MUST also be
      able to discover support for connecting with TLS before initiating a
      stream using &xep0368;
      If a client or server uses &xep0368; to establish a TLS connection (or has
      negotiated TLS in any other way, eg. by using a &rfc7395; or &xep0124;
      connection over HTTPS) the receiving entity MUST NOT advertise STARTTLS in
      the stream features.
      Clients and servers MUST NOT under any circumstances fall back to using an
      unencrypted connection and servers MUST NOT support authenticating over an
      unencrypted connection.
    </p>
  </section1>
  <section1 topic='Authentication Mechanisms' anchor='auth'>
    <p>
      As specified in &rfc6120;, clients and servers that support authentication
      over TLS MUST support the SCRAM-SHA-1-PLUS mechanism (&rfc5802;) with the
      tls-unique channel binding mechanism (&rfc5929;).
      Use of channel binding SHOULD be preferred over plain SCRAM-SHA-1.
      In addition, it is RECOMMENDED that clients and servers that support this
      specification also implement SCRAM-SHA-256-PLUS as specified in &rfc7677;.
      Note that not all TLS stacks provide access to the first TLS Finished
      message, making implementation of the tls-unique channel binding mechanism
      impossible on such stacks.
      Clients and servers that do not have access to the correct channel binding
      bits and do not want to ship a different TLS stack are necessarily NOT
      REQUIRED by this specification to implement channel binding.
    </p>
  </section1>
  <section1 topic='Cipher Suites' anchor='ciphers'>
    <p>
      As specified in &rfc6120; clients and servers MUST support TLS with the
      TLS_RSA_WITH_AES_128_CBC_SHA ciphersuite.
      However, it should only be used as a fallback when absolutely necessary.
      In addition, clients which follow the recommendations and requirements of
      this document MUST implement the following ciphers:
    </p>
    <!-- TODO: Have these vetted or find a reliable source to draw from? -->
    <ul>
      <li>ECDHE-RSA-AES128-GCM-SHA256 (secp384r1)</li>
      <li>DHE-RSA-AES128-SHA256</li>
    </ul>
    <p>
      All cipher suites that use the Diffie-Hellman key agreement method defined
      in &rfc2631; MUST use a DH bitsize of at least 2048 and MUST NOT use a
      common prime.
    </p>
  </section1>
  <section1 topic='Security Considerations' anchor='security'>
    <p>
      When supporting the tls-unique channel binding mechanism the TLS Session
      Hash and Extended Master Secret Extension described in &rfc7627; MUST be
      supported to guarantee the security of the session.
      If the extension is not supported, channel binding MUST NOT be used for
      resumption.
    </p>
    <p>
      Legacy SSL 3.0 and earlier MUST NOT be supported for c2s or s2s
      connections.
      For more information see &rfc6176; and &rfc7568;.
    </p>
  </section1>
  <section1 topic='IANA Considerations' anchor='iana'>
    <p>This document requires no interaction with &IANA;.</p>
  </section1>
  <section1 topic='XMPP Registrar Considerations' anchor='registrar'>
    <p>This document requires no interaction with the &REGISTRAR;.</p>
  </section1>
  <!--
  <section1 topic='Acknowledgements' anchor='ack'>
  </section1>
  -->
</xep>
